









--> CONTINUAMOS NOSSA DISCUSSAO...





NESTA AULA,

VEREMOS COMO 


PODEMOS 


"SEGREGATE THE DUTIES"...







QUEREMOS ENTREGAR ESSA DUTY DE "APLICAR TAGS"




A 1 ROLE ESPECÍFICO,

A 1 ROLE DE "TAG_ADMIN"...

















--> O QUE FAZEMOS, NO CASO,

É CRIAR 






1 ROLE DE "TAG_ADMIN"...










---> AÍ CRIAMOS UMA DATABASE SEPARADA,

DE NOME "TAG_DATABASE"...







--> ASSIGNAMOS ESSA DATABASE "TAG"


A ESSE TAG_ADMIN,


todos os privileges necessários...











--> ESSA DATABASE FICARÁ SOB ESSE ADMIN...










--> DENTRO DESSA DATABASE, DE NOME "TAG",


TEREMOS 1 SCHEMA,

DE NOME "GOVERNANCE"...











--> TODOS OS TAG OBJECTS QUE VAMOS CRIAR/APLICAR 

EM OUTROS OBJECTS, NO SNOWFLAKE,

TUDO ISSO 

VAI VIVER DENTRO 

DESSE 

SCHEMA DE "GOVERNANCE"..












--> E O "TAG_aDMIN"

TERÁ PERMISSIONS PARA APLICAR 

ESSAS TAGS 


EM _ QUALQUER __ DATABASE/SNOWFLAKE 

OBJECTS,



POR MEIO 



DESSE ROLE 


DE "TAG_ADMIN"...











--> COM ISSO, teremos 1 

'CENTRALIZED CONTROL' 

PARA APLICAR AS TAGS 
AO LONGO DE TODA NOSSA CONTA SNOWFLAKE INTEIRA...

(
    com isso, ficará fácil o manage dessas tags, por nós...
)











VEJA O CÓDIGO:













-- Segregation of duties...



USE ROLE USERADMIN;
CREATE ROLE TAG_ADMIN;



USE ROLE ACCOUNTADMIN;
GRANT CREATE TAG ON SCHEMA REVENUE.MEDIA TO ROLE TAG_ADMIN;
GRANT APPLY TAG ON ACCOUNT TO ROLE TAG_ADMIN;

















COM O COMANDO 


DE 

"GRANT APPLY TAG ON ACCOUNT TO ROLE TAG_ADMIN";





ENTREGAMOS PERMISSAO AO TAG_ADMIN PARA QUE 


ELE 

__APLIQUE _ ESSA 

TAG 


AO LONGO DE TODA A SNOWFLAKE ACCOUNT... (em qualquer object)....












--> depois disso,
 o professor dá grants 


 de warehouse para esse role,

 tipo assim:










 USE ROLE TAG_ADMIN;
 USE ROLE SYSADMIN;


 GRANT USAGE ON WAREHOUSE COMPUTE_WH TO ROLE TAG_ADMIN;
 GRANT OPERATE ON WAREHOUSE COMPUTE_WH TO ROLE TAG_ADMIN;

CREATE DATABASE TAG;
CREATE SCHEMA TAG.GOVERNANCE;




GRANT ALL PRIVILEGES ON DATABASE TAG TO ROLE TAG_ADMIN;
GRANT USAGE ON DATABASE TAG TO ROLE TAG_ADMIN;

GRANT ALL PRIVILEGES ON SCHEMA TAG.GOVERNANCE TO ROLE TAG_ADMIN;
GRANT USAGE ON SCHEMA TAG.GOVERNANCE TO ROLE TAG_ADMIN;














USE ROLE TAG_ADMIN;
USE DATABASE TAG;
USE SCHEMA GOVERNANCE;







-- APPLY TAG ON TABLES:

USE ROLE TAG_ADMIN;
USE DATABASE TAG;
USE SCHEMA GOVERNANCE;
























--> NA PRÓXIMA SECTION ENTENDEREMOS MAIS SOBRE 


A SEGREGATION DE DUTIES...
 


 MAS AQUI CRIAMOS 1 ROLE, "TAG_ADMIN",


 e aí ENTREGAMOS PERMISSIONS PARA QUE 

 ELE 
 APLIQUE TAGS EM QUAISQUER SNOWFLAKE OBJECTS...












 --> E TODAS AS TAGS QUE CRIARMOS FICARAO 


 NESSA DATABASE,


 DE "TAG",


 NO SCHEMA DE "GOVERNANCE"...









 NA PRÓXIMA AULA,

 TENTAREMOS CRIAR ALGUMAS SNOWFLAKE TABLES 

 E SCHEMAS...



 tudo para aplicar essas tags...