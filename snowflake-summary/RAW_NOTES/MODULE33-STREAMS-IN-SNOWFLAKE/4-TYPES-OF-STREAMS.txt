








HÁ 2 TIPOS DE STREAMS NO SNOWFLAKE:









1) STANDARD STREAMS 









2) APPEND-ONLY STREAMS...













COISA SIMPLES....









CÓDIGO DO PROFESSOR:









--- CREATE A SOURCE TABLE 

CREATE OR REPLACE TABLE T(id INT, NAME STRING);




-- CREATE A STANDARD STREAM ON THE SOURCE TABLE 
CREATE OR REPLACE STREAM DELTA_S ON TABLE T;


-- CREATE AN APPEND-ONLY STREAM ON THE SOURCE TABLE.

CREATE OR REPLACE STREAM APPEND_ONLY_S ON TABLE T
APPEND_ONLY=TRUE;





-- INSERT 3 ROWS INTO THE SOURCE TABLE 
INSERT INTO T values(0, 'Charlie brown');
INSERT INTO T values(1, 'lucy');
INSERT INTO T values(2, 'linus');









-- DELETE 1 OF 3 ROWS 


DELETE FROM T WHERE ID = '0';














CERTO, ESSA STREAM VAI CAPTURAR APENAS 

DATA CHANGES 

DE TIPO "APPEND"...



















OK, MAS O QUE ACONTECE SE RODAMOS 1 UPDATE, EM VEZ DE INSERT/DELETE?












LESSON LEARNED:







1) STANDARD STREAM CAPTURES ALL DATA CHANGE OPERATION 

ON SOURCE TABLE...




2) APPEND STREAMS ONLY TRACK INSERT OPERATIONS 

ON SOURCE TABLE...











REALMENTE, OPERATIONS DE TIPO "UPDATE" NAO SAO CAPTURADAS 

POR APPEND-ONLY STREAMS...