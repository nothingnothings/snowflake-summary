select WAREHOUSE_NAME,
ROUND(SUM(BYTES_SCANNED)/1000000000,2) AS GB_SCANNED,
ROUND(SUM(BYTES_WRITTEN)/1000000000,2) AS GB_WRITTEN,
ROUND(SUM(BYTES_WRITTEN_TO_RESULT)/1000000000,2) AS GB_WRITTEN_TO_RESULT,
ROUND(SUM(BYTES_SPILLED_TO_LOCAL_STORAGE)/1000000000,2) AS GB_SPILLED_TO_LOCAL_STORAGE,
ROUND(SUM(BYTES_SPILLED_TO_REMOTE_STORAGE)/1000000000,2) AS GB_SPILLED_TO_REMOTE_STORAGE

from snowflake.account_usage.query_history where length(WAREHOUSE_NAME)>0 and to_date(start_time)=:daterange and warehouse_name=:my_warehouse
GROUP BY WAREHOUSE_NAME;
